<mat-card class="card bg-white py-2 px-4">
  <div class="card-title">
    <h3 class="text-center text-dark">Change Password</h3>
  </div>
  <div class="card-body my-3">
    <form [formGroup]="changePasswordForm">
      <mat-form-field appearance="fill">
        <mat-label>Email</mat-label>
        <input matInput formControlName="emailAddress" required>
        <mat-error *ngIf="changePasswordForm.controls.emailAddress.touched && changePasswordForm.controls.emailAddress.invalid">
            <span *ngIf="changePasswordForm.controls.emailAddress.errors.required">This field is mandatory</span>
            <span *ngIf="changePasswordForm.controls.emailAddress.errors.email">Invalid email format</span>
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" fxFlex>
        <mat-label>Old Password</mat-label>
        <input matInput formControlName="oldPassword" type="password" required [type]="oldPassword ? 'password' : 'text'">
        <button type="button" mat-icon-button matSuffix (click)="oldPassword = !oldPassword" [attr.aria-label]="'Hide Password'" [attr.aria-pressed]="oldPassword">
            <mat-icon>{{ oldPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="changePasswordForm.controls.oldPassword.touched && changePasswordForm.controls.oldPassword.invalid">
            <span *ngIf="changePasswordForm.controls.oldPassword.errors.required">This field is mandatory</span>
        </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" fxFlex>
        <mat-label>New Password</mat-label>
        <input matInput formControlName="password" type="password" required [type]="password ? 'password' : 'text'">
        <button type="button" mat-icon-button matSuffix (click)="password = !password" [attr.aria-label]="'Hide Password'" [attr.aria-pressed]="password">
            <mat-icon>{{ password ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="changePasswordForm.controls.password.touched && changePasswordForm.controls.password.invalid">
            <span *ngIf="changePasswordForm.controls.password.errors.required">This field is mandatory</span>
        </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" fxFlex>
        <mat-label>Confirm Password</mat-label>
        <input matInput formControlName="confirmPassword" type="password" required [type]="confirmPassword ? 'password' : 'text'">
        <button type="button" mat-icon-button matSuffix (click)="confirmPassword = !confirmPassword" [attr.aria-label]="'Hide Password'" [attr.aria-pressed]="password">
            <mat-icon>{{ confirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="changePasswordForm.controls.confirmPassword.touched && changePasswordForm.controls.confirmPassword.invalid">
            <span *ngIf="changePasswordForm.controls.confirmPassword.errors.required">This field is mandatory</span>
        </mat-error>
        <mat-hint *ngIf="validateSubmit() && !(changePasswordForm.controls.confirmPassword.invalid)">
            <span>New Password and Confirm Password does not match</span>
        </mat-hint>
    </mat-form-field>
      
    <button mat-raised-button color="primary" type="submit" (click)="handleChangePasswordSubmit()" [disabled]="validateSubmit() || !(changePasswordForm.valid && changePasswordForm.dirty)">
      <mat-icon>save</mat-icon> Update
  </button>
      <button mat-raised-button color="warn" mat-dialog-close class="mx-5">
        <mat-icon>cancel</mat-icon>Close
      </button>
    </form>
  </div>
</mat-card>
